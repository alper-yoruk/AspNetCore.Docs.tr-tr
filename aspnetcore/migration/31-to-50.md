---
title: ASP.NET Core 3,1 ' den 5,0 ' e geçiş yapın
author: scottaddie
description: ASP.NET Core 3,1 projesini ASP.NET Core 5,0 ' e geçirmeyi öğrenin.
ms.author: scaddie
ms.custom: mvc
ms.date: 11/17/2020
no-loc:
- appsettings.json
- ASP.NET Core Identity
- cookie
- Cookie
- Blazor
- Blazor Server
- Blazor WebAssembly
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: migration/31-to-50
ms.openlocfilehash: ea746d0b5292841b0a36f4deaded8fbae8472220
ms.sourcegitcommit: 54fdca99f30b18d69cf0753ca3c84c7dab8f2b0e
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/17/2020
ms.locfileid: "94691189"
---
# <a name="migrate-from-aspnet-core-31-to-50"></a><span data-ttu-id="76684-103">ASP.NET Core 3,1 ' den 5,0 ' e geçiş yapın</span><span class="sxs-lookup"><span data-stu-id="76684-103">Migrate from ASP.NET Core 3.1 to 5.0</span></span>

<span data-ttu-id="76684-104">[Scott Ade](https://github.com/scottaddie) tarafından</span><span class="sxs-lookup"><span data-stu-id="76684-104">By [Scott Addie](https://github.com/scottaddie)</span></span>

<span data-ttu-id="76684-105">Bu makalede, mevcut bir ASP.NET Core 3,1 projesinin ASP.NET Core 5,0 ' e nasıl güncelleştirilmesi açıklanmaktadır.</span><span class="sxs-lookup"><span data-stu-id="76684-105">This article explains how to update an existing ASP.NET Core 3.1 project to ASP.NET Core 5.0.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="76684-106">Önkoşullar</span><span class="sxs-lookup"><span data-stu-id="76684-106">Prerequisites</span></span>

# <a name="visual-studio"></a>[<span data-ttu-id="76684-107">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="76684-107">Visual Studio</span></span>](#tab/visual-studio)

[!INCLUDE[](~/includes/net-core-prereqs-vs-5.0.md)]

# <a name="visual-studio-code"></a>[<span data-ttu-id="76684-108">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="76684-108">Visual Studio Code</span></span>](#tab/visual-studio-code)

[!INCLUDE[](~/includes/net-core-prereqs-vsc-5.0.md)]

# <a name="visual-studio-for-mac"></a>[<span data-ttu-id="76684-109">Mac için Visual Studio</span><span class="sxs-lookup"><span data-stu-id="76684-109">Visual Studio for Mac</span></span>](#tab/visual-studio-mac)

[!INCLUDE[](~/includes/net-core-prereqs-mac-5.0.md)]

---

## <a name="update-net-core-sdk-version-in-globaljson"></a><span data-ttu-id="76684-110">global.jsüzerinde .NET Core SDK sürümü Güncelleştir</span><span class="sxs-lookup"><span data-stu-id="76684-110">Update .NET Core SDK version in global.json</span></span>

<span data-ttu-id="76684-111">Belirli bir .NET Core SDK sürümünü hedeflemek için dosyadaki bir [global.js](/dotnet/core/tools/global-json) kullanıyorsanız, `version` özelliği yüklü olan .NET 5,0 SDK sürümü olarak güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="76684-111">If you rely upon a [global.json](/dotnet/core/tools/global-json) file to target a specific .NET Core SDK version, update the `version` property to the .NET 5.0 SDK version that's installed.</span></span> <span data-ttu-id="76684-112">Örnek:</span><span class="sxs-lookup"><span data-stu-id="76684-112">For example:</span></span>

```diff
{
  "sdk": {
-    "version": "3.1.200"
+    "version": "5.0.100"
  }
}
```

## <a name="update-the-target-framework"></a><span data-ttu-id="76684-113">Hedef çerçeveyi güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="76684-113">Update the target framework</span></span>

<span data-ttu-id="76684-114">Blazor WebAssemblyProjeyi güncelleştiriyorsanız [ Blazor WebAssembly projeleri Güncelleştir](#update-blazor-webassembly-projects) bölümüne atlayın.</span><span class="sxs-lookup"><span data-stu-id="76684-114">If updating a Blazor WebAssembly project, skip to the [Update Blazor WebAssembly projects](#update-blazor-webassembly-projects) section.</span></span> <span data-ttu-id="76684-115">Diğer ASP.NET Core proje türleri için proje dosyasının [hedef Framework bilinen adını (tfd)](/dotnet/standard/frameworks) şu şekilde güncelleştirin `net5.0` :</span><span class="sxs-lookup"><span data-stu-id="76684-115">For any other ASP.NET Core project type, update the project file's [Target Framework Moniker (TFM)](/dotnet/standard/frameworks) to `net5.0`:</span></span>

```diff
<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
-    <TargetFramework>netcoreapp3.1</TargetFramework>
+    <TargetFramework>net5.0</TargetFramework>
  </PropertyGroup>

</Project>
```

## <a name="update-no-locblazor-webassembly-and-no-locblazor-server-projects"></a><span data-ttu-id="76684-116">Güncelleştirme Blazor WebAssembly ve Blazor Server Projeler</span><span class="sxs-lookup"><span data-stu-id="76684-116">Update Blazor WebAssembly and Blazor Server projects</span></span>

<span data-ttu-id="76684-117">*Bu bölümdeki kılavuz, hem Blazor barındırma modelleri için geçerlidir. Bu bölümün takip eden bölümler, barındırma modellerini ve uygulama türlerini barındırmak için ek rehberlik sağlar. Her ilgili bölümden gudnace 'yi uygulamanıza uygulayın.*</span><span class="sxs-lookup"><span data-stu-id="76684-117">*The guidance in this section applies to both Blazor hosting models. Sections following this section provide additional guidance specific to hosting models and app types. Apply the guidnace from all relevant sections to your app.*</span></span>

1. <span data-ttu-id="76684-118">`wwwroot/index.html`Bir Blazor WebAssembly uygulamada veya `Pages/_Host.cshtml` bir Blazor Server uygulamada, `<link>` stiller için öğesine bir öğesi ekleyin `<head>` .</span><span class="sxs-lookup"><span data-stu-id="76684-118">In `wwwroot/index.html` of a Blazor WebAssembly app or the `Pages/_Host.cshtml` of a Blazor Server app, add a `<link>` element to the `<head>` element for styles.</span></span> <span data-ttu-id="76684-119">Aşağıdaki `<link>` öğe `href` öznitelik değerlerinde yer tutucu, `{ASSEMBLY NAME}` uygulamanın derleme adıdır.</span><span class="sxs-lookup"><span data-stu-id="76684-119">In the following `<link>` element `href` attribute values, the placeholder `{ASSEMBLY NAME}` is the app's assembly name.</span></span>

    ```diff
    +<link href="{ASSEMBLY NAME}.styles.css" rel="stylesheet" />
    ```
    
    <span data-ttu-id="76684-120">Tek başına Blazor WebAssembly veya Blazor Server örnek:</span><span class="sxs-lookup"><span data-stu-id="76684-120">Standalone Blazor WebAssembly or Blazor Server example:</span></span>
    
    ```diff
    +<link href="BlazorSample.styles.css" rel="stylesheet" />
    ```

    <span data-ttu-id="76684-121">*`Client`* barındırılan Blazor WebAssembly çözüm örneği projesi:</span><span class="sxs-lookup"><span data-stu-id="76684-121">*`Client`* project of a hosted Blazor WebAssembly solution example:</span></span>
    
    ```diff
    +<link href="BlazorSample.Client.styles.css" rel="stylesheet" />
    ```

1. <span data-ttu-id="76684-122">`_Imports.razor` [Bileşen Sanallaştırması](xref:blazor/components/virtualization)için uygulamanın dosyasına yeni bir ad alanı ekleyin <xref:Microsoft.AspNetCore.Components.Web.Virtualization?displayProperty=fullName> .</span><span class="sxs-lookup"><span data-stu-id="76684-122">Include a new namespace in the app's `_Imports.razor` file for [component virtualization](xref:blazor/components/virtualization), <xref:Microsoft.AspNetCore.Components.Web.Virtualization?displayProperty=fullName>.</span></span> <span data-ttu-id="76684-123">Aşağıdaki `_Imports.razor` dosyalar, proje şablonlarından oluşturulan uygulamalardaki varsayılan ad alanlarını gösterir Blazor .</span><span class="sxs-lookup"><span data-stu-id="76684-123">The following `_Imports.razor` files show the default namespaces in apps generated from the Blazor project templates.</span></span> <span data-ttu-id="76684-124">Yer tutucu, `{ASSEMBLY NAME}` uygulamanın derleme adıdır.</span><span class="sxs-lookup"><span data-stu-id="76684-124">The placeholder `{ASSEMBLY NAME}` is the app's assembly name.</span></span>

   <span data-ttu-id="76684-125">Blazor WebAssembly (`_Imports.razor`):</span><span class="sxs-lookup"><span data-stu-id="76684-125">Blazor WebAssembly (`_Imports.razor`):</span></span>
   
   ```razor
   @using System.Net.Http
   @using System.Net.Http.Json
   @using Microsoft.AspNetCore.Components.Forms
   @using Microsoft.AspNetCore.Components.Routing
   @using Microsoft.AspNetCore.Components.Web
   @using Microsoft.AspNetCore.Components.Web.Virtualization
   @using Microsoft.AspNetCore.Components.WebAssembly.Http
   @using Microsoft.JSInterop
   @using {ASSEMBLY NAME}
   @using {ASSEMBLY NAME}.Shared
   ```

   <span data-ttu-id="76684-126">Blazor Server (`_Imports.razor`):</span><span class="sxs-lookup"><span data-stu-id="76684-126">Blazor Server (`_Imports.razor`):</span></span>
   
   ```razor
   @using System.Net.Http
   @using Microsoft.AspNetCore.Authorization
   @using Microsoft.AspNetCore.Components.Authorization
   @using Microsoft.AspNetCore.Components.Forms
   @using Microsoft.AspNetCore.Components.Routing
   @using Microsoft.AspNetCore.Components.Web
   @using Microsoft.AspNetCore.Components.Web.Virtualization
   @using Microsoft.JSInterop
   @using {ASSEMBLY NAME}
   @using {ASSEMBLY NAME}.Shared
   ```
   
1. <span data-ttu-id="76684-127">`MainLayout`Bileşeninde ( `Shared/MainLayout.razor` ), bileşenin HTML işaretlemesini, `<div>` özniteliği olarak ayarlanmış bir öğeyle çevreleyin `class` `page` :</span><span class="sxs-lookup"><span data-stu-id="76684-127">In the `MainLayout` component (`Shared/MainLayout.razor`), surround the component's HTML markup with a `<div>` element that has a `class` attribute set to `page`:</span></span>

    ```razor
    <div class="page">
    
        ...
        
    </div>
    ```
    
1. <span data-ttu-id="76684-128">Aşağıdaki dosyaları `Shared` klasörüne ekleyin:</span><span class="sxs-lookup"><span data-stu-id="76684-128">Add the following files to the `Shared` folder:</span></span>

    <span data-ttu-id="76684-129">`MainLayout.razor.css`:</span><span class="sxs-lookup"><span data-stu-id="76684-129">`MainLayout.razor.css`:</span></span>
    
    ```css
    .page {
        position: relative;
        display: flex;
        flex-direction: column;
    }

    .main {
        flex: 1;
    }

    .sidebar {
        background-image: linear-gradient(180deg, rgb(5, 39, 103) 0%, #3a0647 70%);
    }

    .top-row {
        background-color: #f7f7f7;
        border-bottom: 1px solid #d6d5d5;
        justify-content: flex-end;
        height: 3.5rem;
        display: flex;
        align-items: center;
    }

        .top-row ::deep a, .top-row .btn-link {
            white-space: nowrap;
            margin-left: 1.5rem;
        }

        .top-row a:first-child {
            overflow: hidden;
            text-overflow: ellipsis;
        }

    @media (max-width: 767.98px) {
        .top-row:not(.auth) {
            display: none;
        }

        .top-row.auth {
            justify-content: space-between;
        }

        .top-row a, .top-row .btn-link {
            margin-left: 0;
        }
    }

    @media (min-width: 768px) {
        .page {
            flex-direction: row;
        }

        .sidebar {
            width: 250px;
            height: 100vh;
            position: sticky;
            top: 0;
        }

        .top-row {
            position: sticky;
            top: 0;
            z-index: 1;
        }

        .main > div {
            padding-left: 2rem !important;
            padding-right: 1.5rem !important;
        }
    }
    ```
    
    <span data-ttu-id="76684-130">`NavMenu.razor.css`:</span><span class="sxs-lookup"><span data-stu-id="76684-130">`NavMenu.razor.css`:</span></span>
    
    ```css
    .navbar-toggler {
        background-color: rgba(255, 255, 255, 0.1);
    }

    .top-row {
        height: 3.5rem;
        background-color: rgba(0,0,0,0.4);
    }

    .navbar-brand {
        font-size: 1.1rem;
    }

    .oi {
        width: 2rem;
        font-size: 1.1rem;
        vertical-align: text-top;
        top: -2px;
    }

    .nav-item {
        font-size: 0.9rem;
        padding-bottom: 0.5rem;
    }

        .nav-item:first-of-type {
            padding-top: 1rem;
        }

        .nav-item:last-of-type {
            padding-bottom: 1rem;
        }

        .nav-item ::deep a {
            color: #d7d7d7;
            border-radius: 4px;
            height: 3rem;
            display: flex;
            align-items: center;
            line-height: 3rem;
        }

    .nav-item ::deep a.active {
        background-color: rgba(255,255,255,0.25);
        color: white;
    }

    .nav-item ::deep a:hover {
        background-color: rgba(255,255,255,0.1);
        color: white;
    }

    @media (min-width: 768px) {
        .navbar-toggler {
            display: none;
        }

        .collapse {
            /* Never collapse the sidebar for wide screens */
            display: block;
        }
    }
    ```

1. <span data-ttu-id="76684-131">Uygulamanın `wwwroot/css/app.css` Blazor WebAssembly veya bir uygulama dosyasının en son temel dosyası `wwwroot/css/site.css` Blazor Server aşağıdaki stilleri içerir.</span><span class="sxs-lookup"><span data-stu-id="76684-131">The latest base `wwwroot/css/app.css` file of a Blazor WebAssembly app or `wwwroot/css/site.css` file of a Blazor Server app includes the following styles.</span></span> <span data-ttu-id="76684-132">Aşağıdaki stilleri ve uygulamaya eklemiş olduğunuz ek stilleri kaldırın.</span><span class="sxs-lookup"><span data-stu-id="76684-132">Remove extra styles leaving the following styles and any that you've added to the app.</span></span>

    <span data-ttu-id="76684-133">Aşağıdaki stil sayfası yalnızca temel stilleri içerir ve geliştirici tarafından eklenen özel **stilleri içermez:**</span><span class="sxs-lookup"><span data-stu-id="76684-133">The following stylesheet only includes base styles and does **not** include custom styles added by the developer:</span></span>
   
    ```css
    @import url('open-iconic/font/css/open-iconic-bootstrap.min.css');

    html, body {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    }

    a, .btn-link {
        color: #0366d6;
    }

    .btn-primary {
        color: #fff;
        background-color: #1b6ec2;
        border-color: #1861ac;
    }

    .content {
        padding-top: 1.1rem;
    }

    .valid.modified:not([type=checkbox]) {
        outline: 1px solid #26b050;
    }

    .invalid {
        outline: 1px solid red;
    }

    .validation-message {
        color: red;
    }

    #blazor-error-ui {
        background: lightyellow;
        bottom: 0;
        box-shadow: 0 -1px 2px rgba(0, 0, 0, 0.2);
        display: none;
        left: 0;
        padding: 0.6rem 1.25rem 0.7rem 1.25rem;
        position: fixed;
        width: 100%;
        z-index: 1000;
    }

    #blazor-error-ui .dismiss {
        cursor: pointer;
        position: absolute;
        right: 0.75rem;
        top: 0.5rem;
    }
    ```

## <a name="update-no-locblazor-webassembly-projects"></a><span data-ttu-id="76684-134">Blazor WebAssemblyProjeleri Güncelleştir</span><span class="sxs-lookup"><span data-stu-id="76684-134">Update Blazor WebAssembly projects</span></span>

<span data-ttu-id="76684-135">Barındırılan bir Blazor WebAssembly çözümün projesi dahil olmak üzere, proje *`Client`* Blazor dosyasında aşağıdaki değişiklikleri uygulayın:</span><span class="sxs-lookup"><span data-stu-id="76684-135">For a Blazor WebAssembly project, including the *`Client`* project of a hosted Blazor solution, apply the following changes to the project file:</span></span>

1. <span data-ttu-id="76684-136">SDK 'yı şuradan Güncelleştir `Microsoft.NET.Sdk.Web` `Microsoft.NET.Sdk.BlazorWebAssembly` :</span><span class="sxs-lookup"><span data-stu-id="76684-136">Update the SDK from `Microsoft.NET.Sdk.Web` to `Microsoft.NET.Sdk.BlazorWebAssembly`:</span></span>

    ```diff
    - <Project Sdk="Microsoft.NET.Sdk.Web">
    + <Project Sdk="Microsoft.NET.Sdk.BlazorWebAssembly">
    ```
    
    > [!NOTE]
    > <span data-ttu-id="76684-137">Bu güncelleştirme yalnızca tek başına Blazor WebAssembly Projeler ve *`Client`* barındırılan çözümlerin projeleri için geçerlidir Blazor .</span><span class="sxs-lookup"><span data-stu-id="76684-137">This update only applies to standalone Blazor WebAssembly projects and the *`Client`* projects of hosted Blazor solutions.</span></span>

1. <span data-ttu-id="76684-138">Aşağıdaki özellikleri güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="76684-138">Update the following properties:</span></span>

    ```diff
    <Project Sdk="Microsoft.NET.Sdk.BlazorWebAssembly">
    
      <PropertyGroup>
    -     <TargetFramework>netstandard2.1</TargetFramework>
    -     <RazorLangVersion>3.0</RazorLangVersion>
    +     <TargetFramework>net5.0</TargetFramework>
      </PropertyGroup>
    ```

1. <span data-ttu-id="76684-139">[Microsoft. AspNetCore. components. WebAssembly. Build](https://www.nuget.org/packages/Microsoft.AspNetCore.Components.WebAssembly.Build)öğesine paket başvurusunu kaldırın:</span><span class="sxs-lookup"><span data-stu-id="76684-139">Remove the package reference to [Microsoft.AspNetCore.Components.WebAssembly.Build](https://www.nuget.org/packages/Microsoft.AspNetCore.Components.WebAssembly.Build):</span></span>

    ```diff
    <ItemGroup>
    -    <PackageReference Include="Microsoft.AspNetCore.Components.WebAssembly.Build" Version="3.2.1" PrivateAssets="all" />
    ```

1. <span data-ttu-id="76684-140">Diğer paketleri en son sürümlerine güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="76684-140">Update other packages to their latest versions.</span></span> <span data-ttu-id="76684-141">En son sürümler [NuGet.org](https://www.nuget.org)adresinde bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="76684-141">The latest versions can be found at [NuGet.org](https://www.nuget.org).</span></span>

1. <span data-ttu-id="76684-142">İçinde `wwwroot/index.html` , bileşeni yükleyen öğeyi değiştirin `App` :</span><span class="sxs-lookup"><span data-stu-id="76684-142">In `wwwroot/index.html`, change the element that loads the `App` component:</span></span>
    
    ```diff
    -<app>Loading...</app>
    +<app id="app">Loading...</app>
    ```
    
1. <span data-ttu-id="76684-143">İçinde `Program.Main` ( `Program.cs` ):</span><span class="sxs-lookup"><span data-stu-id="76684-143">In `Program.Main` (`Program.cs`):</span></span>

   * <span data-ttu-id="76684-144">`<app>`Öğesine bir karma ekleyerek öğenin başvurusunu CSS seçiciyle değiştirin `#` .</span><span class="sxs-lookup"><span data-stu-id="76684-144">Change the reference to the `<app>` element to a CSS selector by adding a hash `#` to it.</span></span>
   * <span data-ttu-id="76684-145">`HttpClient`Kaydı kapsamlı olarak değiştirin.</span><span class="sxs-lookup"><span data-stu-id="76684-145">Change the `HttpClient` registration to scoped.</span></span>

    ```diff
    -builder.RootComponents.Add<App>("app");
    +builder.RootComponents.Add<App>("#app");
    
    -builder.Services.AddTransient(sp => new HttpClient 
    -    { BaseAddress = new Uri(builder.HostEnvironment.BaseAddress) });
    +builder.Services.AddScoped(sp => new HttpClient 
    +    { BaseAddress = new Uri(builder.HostEnvironment.BaseAddress) });
    ```

### <a name="standalone-no-locblazor-webassembly-app-with-microsoft-accounts"></a><span data-ttu-id="76684-146">Blazor WebAssemblyMicrosoft hesaplarıyla tek başına uygulama</span><span class="sxs-lookup"><span data-stu-id="76684-146">Standalone Blazor WebAssembly app with Microsoft Accounts</span></span>

<span data-ttu-id="76684-147">Blazor WebAssemblyMicrosoft hesapları için Azure Active Directory (AAD) kullanmak üzere Azure Portal kayıtlı tek başına bir uygulama için:</span><span class="sxs-lookup"><span data-stu-id="76684-147">For a standalone Blazor WebAssembly app registered in the Azure portal to use Azure Active Directory (AAD) for Microsoft Accounts:</span></span>

* <span data-ttu-id="76684-148">Uygulama `openid` ve `offline_access` kapsamları gerektirir:</span><span class="sxs-lookup"><span data-stu-id="76684-148">The app requires the `openid` and `offline_access` scopes:</span></span>

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes.Add("openid");
  options.ProviderOptions.DefaultAccessTokenScopes.Add("offline_access");
  ```
  
* <span data-ttu-id="76684-149">Azure portal uygulama kaydı **kimlik doğrulaması** dikey penceresinde platform yapılandırmasını, uygulamanın yeniden yönlendirme URI 'Si ile **tek sayfalı uygulama** olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="76684-149">In the Azure portal app registration **Authentication** blade, set the platform configuration to **Single-page application** with the app's redirect URI.</span></span>

* <span data-ttu-id="76684-150">Ayrıca **kimlik doğrulama** dikey penceresinde, **erişim belirteçleri** ve **Kimlik belirteçleri** için **örtülü izni** devre dışı bırakın.</span><span class="sxs-lookup"><span data-stu-id="76684-150">Also in the **Authentication** blade, disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>

<span data-ttu-id="76684-151">Daha fazla bilgi için bkz. <xref:blazor/security/webassembly/standalone-with-microsoft-accounts>.</span><span class="sxs-lookup"><span data-stu-id="76684-151">For more information, see <xref:blazor/security/webassembly/standalone-with-microsoft-accounts>.</span></span>

### <a name="standalone-no-locblazor-webassembly-app-with-azure-active-directory-aad"></a><span data-ttu-id="76684-152">Blazor WebAssemblyAzure Active Directory (AAD) ile tek başına uygulama</span><span class="sxs-lookup"><span data-stu-id="76684-152">Standalone Blazor WebAssembly app with Azure Active Directory (AAD)</span></span>

<span data-ttu-id="76684-153">Blazor WebAssemblyAzure Active Directory (AAD) kullanmak üzere Azure Portal kayıtlı tek başına bir uygulama için:</span><span class="sxs-lookup"><span data-stu-id="76684-153">For a standalone Blazor WebAssembly app registered in the Azure portal to use Azure Active Directory (AAD):</span></span>

* <span data-ttu-id="76684-154">Uygulama için kapsam gereklidir `https://graph.microsoft.com/User.Read` :</span><span class="sxs-lookup"><span data-stu-id="76684-154">The app requires the `https://graph.microsoft.com/User.Read` scope:</span></span>

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes
      .Add("https://graph.microsoft.com/User.Read");
  ```
  
* <span data-ttu-id="76684-155">Azure portal uygulama kaydı **kimlik doğrulaması** dikey penceresinde platform yapılandırmasını, uygulamanın yeniden yönlendirme URI 'Si ile **tek sayfalı uygulama** olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="76684-155">In the Azure portal app registration **Authentication** blade, set the platform configuration to **Single-page application** with the app's redirect URI.</span></span>

* <span data-ttu-id="76684-156">Ayrıca **kimlik doğrulama** dikey penceresinde, **erişim belirteçleri** ve **Kimlik belirteçleri** için **örtülü izni** devre dışı bırakın.</span><span class="sxs-lookup"><span data-stu-id="76684-156">Also in the **Authentication** blade, disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>
  
<span data-ttu-id="76684-157">Daha fazla bilgi için bkz. <xref:blazor/security/webassembly/standalone-with-azure-active-directory>.</span><span class="sxs-lookup"><span data-stu-id="76684-157">For more information, see <xref:blazor/security/webassembly/standalone-with-azure-active-directory>.</span></span>

### <a name="standalone-no-locblazor-app-with-azure-active-directory-aad-b2c"></a><span data-ttu-id="76684-158">BlazorAzure Active Directory (AAD) B2C ile tek başına uygulama</span><span class="sxs-lookup"><span data-stu-id="76684-158">Standalone Blazor app with Azure Active Directory (AAD) B2C</span></span>

<span data-ttu-id="76684-159">Blazor WebAssemblyAzure Active Directory (AAD) B2C 'yi kullanmak için Azure Portal kayıtlı tek başına bir uygulama için:</span><span class="sxs-lookup"><span data-stu-id="76684-159">For a standalone Blazor WebAssembly app registered in the Azure portal to use Azure Active Directory (AAD) B2C:</span></span>

* <span data-ttu-id="76684-160">Uygulama `openid` ve `offline_access` kapsamları gerektirir:</span><span class="sxs-lookup"><span data-stu-id="76684-160">The app requires the `openid` and `offline_access` scopes:</span></span>

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes.Add("openid");
  options.ProviderOptions.DefaultAccessTokenScopes.Add("offline_access");
  ```
  
* <span data-ttu-id="76684-161">Azure portal uygulama kaydı **kimlik doğrulaması** dikey penceresinde platform yapılandırmasını, uygulamanın yeniden yönlendirme URI 'Si ile **tek sayfalı uygulama** olarak ayarlayın.</span><span class="sxs-lookup"><span data-stu-id="76684-161">In the Azure portal app registration **Authentication** blade, set the platform configuration to **Single-page application** with the app's redirect URI.</span></span>

* <span data-ttu-id="76684-162">Ayrıca **kimlik doğrulama** dikey penceresinde, **erişim belirteçleri** ve **Kimlik belirteçleri** için **örtülü izni** devre dışı bırakın.</span><span class="sxs-lookup"><span data-stu-id="76684-162">Also in the **Authentication** blade, disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>

<span data-ttu-id="76684-163">Daha fazla bilgi için bkz. <xref:blazor/security/webassembly/standalone-with-azure-active-directory-b2c>.</span><span class="sxs-lookup"><span data-stu-id="76684-163">For more information, see <xref:blazor/security/webassembly/standalone-with-azure-active-directory-b2c>.</span></span>

### <a name="hosted-no-locblazor-webassembly-app-with-azure-active-directory-aad-or-b2c"></a><span data-ttu-id="76684-164">Blazor WebAssemblyAzure Active Directory (AAD) veya B2C ile barındırılan uygulama</span><span class="sxs-lookup"><span data-stu-id="76684-164">Hosted Blazor WebAssembly app with Azure Active Directory (AAD) or B2C</span></span>

<span data-ttu-id="76684-165">*`Client`* Blazor Kullanıcı kimlik doğrulaması için AAD veya AAD B2C kullanan bir barındırılan çözümün uygulama kaydı, **tek sayfalı uygulama** Azure Apps platform yapılandırması kullanmalıdır:</span><span class="sxs-lookup"><span data-stu-id="76684-165">The *`Client`* app registration of a hosted Blazor solution that uses AAD or AAD B2C for user authentication should use a **Single-page application** Azure Apps platform configuration:</span></span>

1. <span data-ttu-id="76684-166">Uygulama için Azure portal uygulama kaydında *`Client`* **Web** platformu yapılandırmasını kaldırın.</span><span class="sxs-lookup"><span data-stu-id="76684-166">In the Azure portal app registration for the *`Client`* app, remove the **Web** platform configuration.</span></span>
1. <span data-ttu-id="76684-167">Uygulamanın yeniden yönlendirme URI 'SI ile **tek sayfalı bir uygulama** platformu yapılandırması ekleyin.</span><span class="sxs-lookup"><span data-stu-id="76684-167">Add a **Single-page application** platform configuration with the app's redirect URI.</span></span>
1. <span data-ttu-id="76684-168">**Erişim belirteçleri** ve **Kimlik belirteçleri** için **örtük izni** devre dışı bırakın.</span><span class="sxs-lookup"><span data-stu-id="76684-168">Disable **Implicit grant** for **Access tokens** and **ID tokens**.</span></span>

<span data-ttu-id="76684-169">Daha fazla bilgi için bkz:</span><span class="sxs-lookup"><span data-stu-id="76684-169">For more information, see:</span></span>

* <xref:blazor/security/webassembly/hosted-with-azure-active-directory>
* <xref:blazor/security/webassembly/hosted-with-azure-active-directory-b2c>

### <a name="update-the-server-project-of-a-hosted-no-locblazor-solution"></a><span data-ttu-id="76684-170">Barındırılan bir çözümün sunucu projesini güncelleştirme Blazor</span><span class="sxs-lookup"><span data-stu-id="76684-170">Update the Server project of a hosted Blazor solution</span></span>

<span data-ttu-id="76684-171">Barındırılan bir *`Server`* çözümün projesini, Blazor Bu makaledeki genel kılavuzdan sonra ASP.NET Core uygulama olarak güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="76684-171">Update the *`Server`* project of a hosted Blazor solution as an ASP.NET Core app following the general guidance in this article.</span></span>

<span data-ttu-id="76684-172">Ayrıca, *`Server`* Blazor WebAssembly Azure ACTIVE DIRECTORY (AAD) veya B2C ile istemci uygulamalarında kullanıcıların kimliğini doğrulayan projeler yeni Microsoft Identity v 2.0 paketlerini benimsemelidir:</span><span class="sxs-lookup"><span data-stu-id="76684-172">Additionally, *`Server`* projects that authenticate users to client Blazor WebAssembly apps with Azure Active Directory (AAD) or B2C should adopt new Microsoft Identity v2.0 packages:</span></span> 
  
<span data-ttu-id="76684-173">AAD için:</span><span class="sxs-lookup"><span data-stu-id="76684-173">For AAD:</span></span>

```diff
-<PackageReference Include="Microsoft.AspNetCore.Authentication.AzureAD.UI" Version="..." />
+<PackageReference Include="Microsoft.Identity.Web" Version="1.2.0" />
+<PackageReference Include="Microsoft.Identity.Web.UI" Version="1.2.0" />
```

<span data-ttu-id="76684-174">AAD B2C için:</span><span class="sxs-lookup"><span data-stu-id="76684-174">For AAD B2C:</span></span>

```diff
-<PackageReference Include="Microsoft.AspNetCore.Authentication.AzureADB2C.UI" Version="..." />
+<PackageReference Include="Microsoft.Identity.Web" Version="1.2.0" />
+<PackageReference Include="Microsoft.Identity.Web.UI" Version="1.2.0" />
```

> [!NOTE]
> <span data-ttu-id="76684-175">*`Server`* Barındırılan çözümde projenin SDK 'sı Blazor WebAssembly kalır `Microsoft.NET.Sdk.Web` :</span><span class="sxs-lookup"><span data-stu-id="76684-175">The SDK of the *`Server`* project in a hosted Blazor WebAssembly solution remains `Microsoft.NET.Sdk.Web`:</span></span>
>
> ```xml
> <Project Sdk="Microsoft.NET.Sdk.Web">
> ```

<span data-ttu-id="76684-176">Daha fazla bilgi için bkz:</span><span class="sxs-lookup"><span data-stu-id="76684-176">For more information, see:</span></span>

* <xref:blazor/security/webassembly/hosted-with-azure-active-directory>
* <xref:blazor/security/webassembly/hosted-with-azure-active-directory-b2c>

### <a name="unauthorized-client-for-azure-active-directory-aad"></a><span data-ttu-id="76684-177">Azure Active Directory için yetkisiz istemci (AAD)</span><span class="sxs-lookup"><span data-stu-id="76684-177">Unauthorized client for Azure Active Directory (AAD)</span></span>

<span data-ttu-id="76684-178">Blazor WebAssemblyKimlik doğrulaması IÇIN AAD kullanan bir uygulamayı yükselttikten sonra, Kullanıcı AAD ile oturum açtıktan sonra uygulamaya oturum açma geri aramasında aşağıdaki hatayı alabilirsiniz:</span><span class="sxs-lookup"><span data-stu-id="76684-178">After upgrading a Blazor WebAssembly app that uses AAD for authentication, you may receive the following error on the login callback to the app after the user signs in with AAD:</span></span>

> <span data-ttu-id="76684-179">bilgi: Microsoft. AspNetCore. Authorization. DefaultAuthorizationService [2] yetkilendirmesi başarısız oldu.</span><span class="sxs-lookup"><span data-stu-id="76684-179">info: Microsoft.AspNetCore.Authorization.DefaultAuthorizationService[2] Authorization failed.</span></span> <span data-ttu-id="76684-180">Bu gereksinimler karşılanmadı: DenyAnonymousAuthorizationRequirement: kimliği doğrulanmış bir kullanıcı gerektirir.</span><span class="sxs-lookup"><span data-stu-id="76684-180">These requirements were not met: DenyAnonymousAuthorizationRequirement: Requires an authenticated user.</span></span>

<span data-ttu-id="76684-181">AAD 'den oturum açma geri çağırma hatası:</span><span class="sxs-lookup"><span data-stu-id="76684-181">Login callback error from AAD:</span></span>

* <span data-ttu-id="76684-182">Hata: `unauthorized_client`</span><span class="sxs-lookup"><span data-stu-id="76684-182">Error: `unauthorized_client`</span></span>
* <span data-ttu-id="76684-183">Açıklaması `AADB2C90058: The provided application is not configured to allow public clients.`</span><span class="sxs-lookup"><span data-stu-id="76684-183">Description: `AADB2C90058: The provided application is not configured to allow public clients.`</span></span>

<span data-ttu-id="76684-184">Hatayı gidermek için:</span><span class="sxs-lookup"><span data-stu-id="76684-184">To resolve the error:</span></span>

1. <span data-ttu-id="76684-185">Azure portal, [uygulamanın bildirimine](/azure/active-directory/develop/reference-app-manifest)erişin.</span><span class="sxs-lookup"><span data-stu-id="76684-185">In the Azure portal, access the [app's manifest](/azure/active-directory/develop/reference-app-manifest).</span></span>
1. <span data-ttu-id="76684-186">[`allowPublicClient`](/azure/active-directory/develop/reference-app-manifest#allowpublicclient-attribute)Özniteliğini veya olarak ayarlayın `null` `true` .</span><span class="sxs-lookup"><span data-stu-id="76684-186">Set the [`allowPublicClient`](/azure/active-directory/develop/reference-app-manifest#allowpublicclient-attribute) attribute to `null` or `true`.</span></span>

## <a name="update-no-locrazor-class-libraries-rcls"></a><span data-ttu-id="76684-187">RazorSınıf kitaplıklarını güncelleştirme (RCLs)</span><span class="sxs-lookup"><span data-stu-id="76684-187">Update Razor class libraries (RCLs)</span></span>

<span data-ttu-id="76684-188">RazorASP.NET Core 5,0 kapsamında sunulan yeni API 'lerden veya özelliklerden yararlanmak için sınıf kitaplıklarını (RCLs) geçirin.</span><span class="sxs-lookup"><span data-stu-id="76684-188">Migrate Razor class libraries (RCLs) to take advantage of new APIs or features that are introduced as part of ASP.NET Core 5.0.</span></span> 

<span data-ttu-id="76684-189">Bileşenleri hedefleyen bir RCL 'yi güncelleştirmek için:</span><span class="sxs-lookup"><span data-stu-id="76684-189">To update a RCL that targets components:</span></span>

1. <span data-ttu-id="76684-190">Proje dosyasında aşağıdaki özellikleri güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="76684-190">Update the following properties in the project file:</span></span>

   ```diff
   <Project Sdk="Microsoft.NET.Sdk.Razor">
    
     <PropertyGroup>
   -     <TargetFramework>netstandard2.0</TargetFramework>
   -     <RazorLangVersion>3.0</RazorLangVersion>
   +     <TargetFramework>net5.0</TargetFramework>
     </PropertyGroup>
   ```

1. <span data-ttu-id="76684-191">Diğer paketleri en son sürümlerine güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="76684-191">Update other packages to their latest versions.</span></span> <span data-ttu-id="76684-192">En son sürümler [NuGet.org](https://www.nuget.org)adresinde bulunabilir.</span><span class="sxs-lookup"><span data-stu-id="76684-192">The latest versions can be found at [NuGet.org](https://www.nuget.org).</span></span>

<span data-ttu-id="76684-193">Bir RCL hedefleme MVC 'yi güncelleştirmek için proje dosyasında aşağıdaki özellikleri güncelleştirin:</span><span class="sxs-lookup"><span data-stu-id="76684-193">To update an RCL targeting MVC, update the following properties in the project file:</span></span>

```diff
<Project Sdk="Microsoft.NET.Sdk.Razor">

  <PropertyGroup>
-    <TargetFramework>netcoreapp3.1</TargetFramework>
+    <TargetFramework>net5.0</TargetFramework>
    <AddRazorSupportForMvc>true</AddRazorSupportForMvc>
  </PropertyGroup>
```

## <a name="update-package-references"></a><span data-ttu-id="76684-194">Paket başvurularını Güncelleştir</span><span class="sxs-lookup"><span data-stu-id="76684-194">Update package references</span></span>

<span data-ttu-id="76684-195">Proje dosyasında, her bir [Microsoft. AspNetCore. \*](https://www.nuget.org/packages?q=Microsoft.AspNetCore.*), [Microsoft. entityframeworkcore. \*](https://www.nuget.org/packages?q=Microsoft.EntityFrameworkCore.*), [Microsoft. Extensions. \*](https://www.nuget.org/packages?q=Microsoft.Extensions.*)ve [System.Net.Http.Js](https://www.nuget.org/packages/System.Net.Http.Json) paket başvurusunun `Version` özniteliğinde 5.0.0 veya sonraki bir sürüme güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="76684-195">In the project file, update each [Microsoft.AspNetCore.\*](https://www.nuget.org/packages?q=Microsoft.AspNetCore.*), [Microsoft.EntityFrameworkCore.\*](https://www.nuget.org/packages?q=Microsoft.EntityFrameworkCore.*), [Microsoft.Extensions.\*](https://www.nuget.org/packages?q=Microsoft.Extensions.*), and [System.Net.Http.Json](https://www.nuget.org/packages/System.Net.Http.Json) package reference's `Version` attribute to 5.0.0 or later.</span></span> <span data-ttu-id="76684-196">Örnek:</span><span class="sxs-lookup"><span data-stu-id="76684-196">For example:</span></span>

```diff
<ItemGroup>
-    <PackageReference Include="Microsoft.AspNetCore.JsonPatch" Version="3.1.6" />
-    <PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="3.1.6">
-    <PackageReference Include="Microsoft.Extensions.Caching.Abstractions" Version="3.1.6" />
-    <PackageReference Include="System.Net.Http.Json" Version="3.2.1" />
+    <PackageReference Include="Microsoft.AspNetCore.JsonPatch" Version="5.0.0" />
+    <PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="5.0.0">
+    <PackageReference Include="Microsoft.Extensions.Caching.Abstractions" Version="5.0.0" />
+    <PackageReference Include="System.Net.Http.Json" Version="5.0.0" />
</ItemGroup>
```

## <a name="update-docker-images"></a><span data-ttu-id="76684-197">Docker görüntülerini güncelleştirme</span><span class="sxs-lookup"><span data-stu-id="76684-197">Update Docker images</span></span>

<span data-ttu-id="76684-198">Docker kullanan uygulamalar için *Dockerfile* `FROM` deyimlerinizi ve betikleri güncelleştirin.</span><span class="sxs-lookup"><span data-stu-id="76684-198">For apps using Docker, update your *Dockerfile* `FROM` statements and scripts.</span></span> <span data-ttu-id="76684-199">ASP.NET Core 5,0 çalışma zamanını içeren bir temel görüntü kullanın.</span><span class="sxs-lookup"><span data-stu-id="76684-199">Use a base image that includes the ASP.NET Core 5.0 runtime.</span></span> <span data-ttu-id="76684-200">`docker pull`ASP.NET Core 3,1 ve 5,0 arasındaki aşağıdaki komut farkını göz önünde bulundurun:</span><span class="sxs-lookup"><span data-stu-id="76684-200">Consider the following `docker pull` command difference between ASP.NET Core 3.1 and 5.0:</span></span>

```diff
- docker pull mcr.microsoft.com/dotnet/core/aspnet:3.1
+ docker pull mcr.microsoft.com/dotnet/aspnet:5.0
```

<span data-ttu-id="76684-201">Ürün adı olarak ".NET" e taşıma kapsamında, Docker görüntüleri `mcr.microsoft.com/dotnet/core` depolardan öğesine taşınır `mcr.microsoft.com/dotnet` .</span><span class="sxs-lookup"><span data-stu-id="76684-201">As part of the move to ".NET" as the product name, the Docker images moved from the `mcr.microsoft.com/dotnet/core` repositories to `mcr.microsoft.com/dotnet`.</span></span> <span data-ttu-id="76684-202">Daha fazla bilgi için bkz. [DotNet/DotNet-Docker # 1939](https://github.com/dotnet/dotnet-docker/issues/1939).</span><span class="sxs-lookup"><span data-stu-id="76684-202">For more information, see [dotnet/dotnet-docker#1939](https://github.com/dotnet/dotnet-docker/issues/1939).</span></span>

## <a name="model-binding-changes-in-aspnet-core-mvc-and-no-locrazor-pages"></a><span data-ttu-id="76684-203">ASP.NET Core MVC ve sayfalarında model bağlama değişiklikleri Razor</span><span class="sxs-lookup"><span data-stu-id="76684-203">Model binding changes in ASP.NET Core MVC and Razor Pages</span></span>

### <a name="datetime-values-are-model-bound-as-utc-times"></a><span data-ttu-id="76684-204">DateTime değerleri UTC zamanları olarak modeldir</span><span class="sxs-lookup"><span data-stu-id="76684-204">DateTime values are model bound as UTC times</span></span>

<span data-ttu-id="76684-205">ASP.NET Core 3,1 ve önceki sürümlerde, `DateTime` değerler saat diliminin sunucu tarafından belirlendiği yerel saat olarak model bağlasıydı.</span><span class="sxs-lookup"><span data-stu-id="76684-205">In ASP.NET Core 3.1 and earlier, `DateTime` values were model-bound as local time, where the timezone was determined by the server.</span></span> <span data-ttu-id="76684-206">`DateTime` Giriş biçimlendirme (JSON) ve değerleri ile sınırlı değerler `DateTimeOffset` UTC Timezones olarak bağlıydı.</span><span class="sxs-lookup"><span data-stu-id="76684-206">`DateTime` values bound from input formatting (JSON) and `DateTimeOffset` values were bound as UTC timezones.</span></span>

<span data-ttu-id="76684-207">ASP.NET Core 5,0 ve üzeri sürümlerde, model bağlama `DateTime` DEĞERLERI UTC saat dilimiyle tutarlı bir şekilde bağlar.</span><span class="sxs-lookup"><span data-stu-id="76684-207">In ASP.NET Core 5.0 and later, model binding consistently binds `DateTime` values with the UTC timezone.</span></span>

<span data-ttu-id="76684-208">Önceki davranışı sürdürmek için, `DateTimeModelBinderProvider` içindeki ' ı kaldırın `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="76684-208">To retain the previous behavior, remove the `DateTimeModelBinderProvider` in `Startup.ConfigureServices`:</span></span>

```csharp
services.AddControllersWithViews(options => 
    options.ModelBinderProviders.RemoveType<DateTimeModelBinderProvider>());
```

### <a name="complexobjectmodelbinderprovider--complexobjectmodelbinder-replace-complextypemodelbinderprovider--complextypemodelbinder"></a><span data-ttu-id="76684-209">ComplexObjectModelBinderProvider \ Complexobjectmodelciltçi Replace ComplexTypeModelBinderProvider \ Complextypemodelciltçi</span><span class="sxs-lookup"><span data-stu-id="76684-209">ComplexObjectModelBinderProvider \ ComplexObjectModelBinder replace ComplexTypeModelBinderProvider \ ComplexTypeModelBinder</span></span>

<span data-ttu-id="76684-210">Model bağlama [C# 9 kayıt türleri](/dotnet/csharp/whats-new/csharp-9#record-types)için destek eklemek üzere, <xref:Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider> Şu olur:</span><span class="sxs-lookup"><span data-stu-id="76684-210">To add support for model binding [C# 9 record types](/dotnet/csharp/whats-new/csharp-9#record-types), the <xref:Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider> is:</span></span>

* <span data-ttu-id="76684-211">Eski olarak açıklanmalıdır.</span><span class="sxs-lookup"><span data-stu-id="76684-211">Annotated as obsolete.</span></span>
* <span data-ttu-id="76684-212">Artık varsayılan olarak kayıtlı değildir.</span><span class="sxs-lookup"><span data-stu-id="76684-212">No longer registered by default.</span></span>

<span data-ttu-id="76684-213">Koleksiyonda bulunan öğesinin varlığına bağlı olan uygulamaların `ComplexTypeModelBinderProvider` `ModelBinderProviders` Yeni Ciltçi sağlayıcısına başvurması gerekir:</span><span class="sxs-lookup"><span data-stu-id="76684-213">Apps that rely on the presence of the `ComplexTypeModelBinderProvider` in the `ModelBinderProviders` collection need to reference the new binder provider:</span></span>

```diff
- var complexModelBinderProvider = options.ModelBinderProviders.OfType<ComplexTypeModelBinderProvider>();
+ var complexModelBinderProvider = options.ModelBinderProviders.OfType<ComplexObjectModelBinderProvider>();
```

## <a name="review-breaking-changes"></a><span data-ttu-id="76684-214">Son değişiklikleri gözden geçir</span><span class="sxs-lookup"><span data-stu-id="76684-214">Review breaking changes</span></span>

<span data-ttu-id="76684-215">.NET Core 3,1 ' den .NET 5,0 ' ye son değişiklikler için, [sürüm 3,1 ' den 5,0 ' e geçiş Için Son değişiklikler](/dotnet/core/compatibility/3.1-5.0)konusuna bakın</span><span class="sxs-lookup"><span data-stu-id="76684-215">For breaking changes from .NET Core 3.1 to .NET 5.0, see [Breaking changes for migration from version 3.1 to 5.0](/dotnet/core/compatibility/3.1-5.0).</span></span> <span data-ttu-id="76684-216">ASP.NET Core ve Entity Framework Core listede de bulunur.</span><span class="sxs-lookup"><span data-stu-id="76684-216">ASP.NET Core and Entity Framework Core are also included in the list.</span></span>
