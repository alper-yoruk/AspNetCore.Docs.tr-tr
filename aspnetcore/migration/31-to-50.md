---
title: ASP.NET Core 3,1 ' den 5,0 ' e geçiş yapın
author: scottaddie
description: ASP.NET Core 3,1 projesini ASP.NET Core 5,0 ' e geçirmeyi öğrenin.
ms.author: scaddie
ms.custom: mvc
ms.date: 11/10/2020
no-loc:
- appsettings.json
- ASP.NET Core Identity
- cookie
- Cookie
- Blazor
- Blazor Server
- Blazor WebAssembly
- Identity
- Let's Encrypt
- Razor
- SignalR
uid: migration/31-to-50
ms.openlocfilehash: df62dcdbb264ebc945aa6cf91ee9d8791f33c392
ms.sourcegitcommit: fbd5427293d9ecccc388bd5fd305c2eb8ada7281
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 11/10/2020
ms.locfileid: "94464230"
---
# <a name="migrate-from-aspnet-core-31-to-50"></a>ASP.NET Core 3,1 ' den 5,0 ' e geçiş yapın

[Scott Ade](https://github.com/scottaddie) tarafından

Bu makalede, mevcut bir ASP.NET Core 3,1 projesinin ASP.NET Core 5,0 ' e nasıl güncelleştirilmesi açıklanmaktadır.

## <a name="prerequisites"></a>Önkoşullar

# <a name="visual-studio"></a>[Visual Studio](#tab/visual-studio)

[!INCLUDE[](~/includes/net-core-prereqs-vs-5.0.md)]

# <a name="visual-studio-code"></a>[Visual Studio Code](#tab/visual-studio-code)

[!INCLUDE[](~/includes/net-core-prereqs-vsc-5.0.md)]

# <a name="visual-studio-for-mac"></a>[Mac için Visual Studio](#tab/visual-studio-mac)

[!INCLUDE[](~/includes/net-core-prereqs-mac-5.0.md)]

---

## <a name="update-net-core-sdk-version-in-globaljson"></a>global.jsüzerinde .NET Core SDK sürümü Güncelleştir

Belirli bir .NET Core SDK sürümünü hedeflemek için dosyadaki bir [global.js](/dotnet/core/tools/global-json) kullanıyorsanız, `version` özelliği yüklü olan .NET 5,0 SDK sürümü olarak güncelleştirin. Örneğin:

```diff
{
  "sdk": {
-    "version": "3.1.200"
+    "version": "5.0.100"
  }
}
```

## <a name="update-the-target-framework"></a>Hedef çerçeveyi güncelleştirme

Blazor WebAssemblyProjeyi güncelleştiriyorsanız [ Blazor WebAssembly projeleri Güncelleştir](#update-blazor-webassembly-projects) bölümüne atlayın. Diğer ASP.NET Core proje türleri için proje dosyasının [hedef Framework bilinen adını (tfd)](/dotnet/standard/frameworks) şu şekilde güncelleştirin `net5.0` :

```diff
<Project Sdk="Microsoft.NET.Sdk.Web">

  <PropertyGroup>
-    <TargetFramework>netcoreapp3.1</TargetFramework>
+    <TargetFramework>net5.0</TargetFramework>
  </PropertyGroup>

</Project>
```

## <a name="update-no-locblazor-webassembly-projects"></a>Blazor WebAssemblyProjeleri Güncelleştir

Barındırılan bir Blazor WebAssembly çözümün projesi dahil olmak üzere, proje *`Client`* Blazor dosyasında aşağıdaki değişiklikleri uygulayın:

1. SDK 'yı şuradan Güncelleştir `Microsoft.NET.Sdk.Web` `Microsoft.NET.Sdk.BlazorWebAssembly` :

    ```diff
    - <Project Sdk="Microsoft.NET.Sdk.Web">
    + <Project Sdk="Microsoft.NET.Sdk.BlazorWebAssembly">
    ```

1. Aşağıdaki özellikleri güncelleştirin:

    ```diff
    <Project Sdk="Microsoft.NET.Sdk.BlazorWebAssembly">
    
      <PropertyGroup>
    -     <TargetFramework>netstandard2.1</TargetFramework>
    -     <RazorLangVersion>3.0</RazorLangVersion>
    +     <TargetFramework>net5.0</TargetFramework>
      </PropertyGroup>
    ```

1. [Microsoft. AspNetCore. components. WebAssembly. Build](https://www.nuget.org/packages/Microsoft.AspNetCore.Components.WebAssembly.Build)öğesine paket başvurusunu kaldırın:

    ```diff
    <ItemGroup>
    -    <PackageReference Include="Microsoft.AspNetCore.Components.WebAssembly.Build" Version="3.2.1" PrivateAssets="all" />
    ```

1. Diğer paketleri en son sürümlerine güncelleştirin. En son sürümler [NuGet.org](https://www.nuget.org)adresinde bulunabilir.

### <a name="standalone-no-locblazor-webassembly-app-with-microsoft-accounts"></a>Blazor WebAssemblyMicrosoft hesaplarıyla tek başına uygulama

Blazor WebAssemblyMicrosoft hesapları için Azure Active Directory (AAD) kullanmak üzere Azure Portal kayıtlı tek başına bir uygulama için:

* Uygulama `openid` ve `offline_access` kapsamları gerektirir:

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes.Add("openid");
  options.ProviderOptions.DefaultAccessTokenScopes.Add("offline_access");
  ```
  
* Azure portal uygulama kaydı **kimlik doğrulaması** dikey penceresinde platform yapılandırmasını, uygulamanın yeniden yönlendirme URI 'Si ile **tek sayfalı uygulama** olarak ayarlayın.

* Ayrıca **kimlik doğrulama** dikey penceresinde, **erişim belirteçleri** ve **Kimlik belirteçleri** için **örtülü izni** devre dışı bırakın.

Daha fazla bilgi için bkz. <xref:blazor/security/webassembly/standalone-with-microsoft-accounts>.

### <a name="standalone-no-locblazor-webassembly-app-with-azure-active-directory-aad"></a>Blazor WebAssemblyAzure Active Directory (AAD) ile tek başına uygulama

Blazor WebAssemblyAzure Active Directory (AAD) kullanmak üzere Azure Portal kayıtlı tek başına bir uygulama için:

* Uygulama için kapsam gereklidir `https://graph.microsoft.com/User.Read` :

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes
      .Add("https://graph.microsoft.com/User.Read");
  ```
  
* Azure portal uygulama kaydı **kimlik doğrulaması** dikey penceresinde platform yapılandırmasını, uygulamanın yeniden yönlendirme URI 'Si ile **tek sayfalı uygulama** olarak ayarlayın.

* Ayrıca **kimlik doğrulama** dikey penceresinde, **erişim belirteçleri** ve **Kimlik belirteçleri** için **örtülü izni** devre dışı bırakın.
  
Daha fazla bilgi için bkz. <xref:blazor/security/webassembly/standalone-with-azure-active-directory>.

### <a name="standalone-no-locblazor-app-with-azure-active-directory-aad-b2c"></a>BlazorAzure Active Directory (AAD) B2C ile tek başına uygulama

Blazor WebAssemblyAzure Active Directory (AAD) B2C 'yi kullanmak için Azure Portal kayıtlı tek başına bir uygulama için:

* Uygulama `openid` ve `offline_access` kapsamları gerektirir:

  ```csharp
  options.ProviderOptions.DefaultAccessTokenScopes.Add("openid");
  options.ProviderOptions.DefaultAccessTokenScopes.Add("offline_access");
  ```
  
* Azure portal uygulama kaydı **kimlik doğrulaması** dikey penceresinde platform yapılandırmasını, uygulamanın yeniden yönlendirme URI 'Si ile **tek sayfalı uygulama** olarak ayarlayın.

* Ayrıca **kimlik doğrulama** dikey penceresinde, **erişim belirteçleri** ve **Kimlik belirteçleri** için **örtülü izni** devre dışı bırakın.

Daha fazla bilgi için bkz. <xref:blazor/security/webassembly/standalone-with-azure-active-directory-b2c>.

### <a name="hosted-no-locblazor-webassembly-app-with-azure-active-directory-aad-or-b2c"></a>Blazor WebAssemblyAzure Active Directory (AAD) veya B2C ile barındırılan uygulama

*`Client`* Blazor Kullanıcı kimlik doğrulaması için AAD veya AAD B2C kullanan bir barındırılan çözümün uygulama kaydı, **tek sayfalı uygulama** Azure Apps platform yapılandırması kullanmalıdır:

1. Uygulama için Azure portal uygulama kaydında *`Client`* **Web** platformu yapılandırmasını kaldırın.
1. Uygulamanın yeniden yönlendirme URI 'SI ile **tek sayfalı bir uygulama** platformu yapılandırması ekleyin.
1. **Erişim belirteçleri** ve **Kimlik belirteçleri** için **örtük izni** devre dışı bırakın.

Daha fazla bilgi için bkz:

* <xref:blazor/security/webassembly/hosted-with-azure-active-directory>
* <xref:blazor/security/webassembly/hosted-with-azure-active-directory-b2c>

### <a name="update-the-server-project-of-a-hosted-no-locblazor-solution"></a>Barındırılan bir çözümün sunucu projesini güncelleştirme Blazor

Barındırılan bir *`Server`* çözümün projesini, Blazor Bu makaledeki genel kılavuzdan sonra ASP.NET Core uygulama olarak güncelleştirin.

Ayrıca, *`Server`* Blazor WebAssembly Azure ACTIVE DIRECTORY (AAD) veya B2C ile istemci uygulamalarında kullanıcıların kimliğini doğrulayan projeler yeni Microsoft Identity v 2.0 paketlerini benimsemelidir: 
  
AAD için:

```diff
-<PackageReference Include="Microsoft.AspNetCore.Authentication.AzureAD.UI" Version="..." />
+<PackageReference Include="Microsoft.Identity.Web" Version="1.2.0" />
+<PackageReference Include="Microsoft.Identity.Web.UI" Version="1.2.0" />
```

AAD B2C için:

```diff
-<PackageReference Include="Microsoft.AspNetCore.Authentication.AzureADB2C.UI" Version="..." />
+<PackageReference Include="Microsoft.Identity.Web" Version="1.2.0" />
+<PackageReference Include="Microsoft.Identity.Web.UI" Version="1.2.0" />
```

Daha fazla bilgi için bkz:

* <xref:blazor/security/webassembly/hosted-with-azure-active-directory>
* <xref:blazor/security/webassembly/hosted-with-azure-active-directory-b2c>

### <a name="unauthorized-client-for-azure-active-directory-aad"></a>Azure Active Directory için yetkisiz istemci (AAD)

Blazor WebAssemblyKimlik doğrulaması IÇIN AAD kullanan bir uygulamayı yükselttikten sonra, Kullanıcı AAD ile oturum açtıktan sonra uygulamaya oturum açma geri aramasında aşağıdaki hatayı alabilirsiniz:

> bilgi: Microsoft. AspNetCore. Authorization. DefaultAuthorizationService [2] yetkilendirmesi başarısız oldu. Bu gereksinimler karşılanmadı: DenyAnonymousAuthorizationRequirement: kimliği doğrulanmış bir kullanıcı gerektirir.

AAD 'den oturum açma geri çağırma hatası:

* Hata: `unauthorized_client`
* Açıklaması `AADB2C90058: The provided application is not configured to allow public clients.`

Hatayı gidermek için:

1. Azure portal, [uygulamanın bildirimine](/azure/active-directory/develop/reference-app-manifest)erişin.
1. [`allowPublicClient`](/azure/active-directory/develop/reference-app-manifest#allowpublicclient-attribute)Özniteliğini veya olarak ayarlayın `null` `true` .

## <a name="update-package-references"></a>Paket başvurularını Güncelleştir

Proje dosyasında, her bir [Microsoft. AspNetCore. *](https://www.nuget.org/packages?q=Microsoft.AspNetCore.*), [Microsoft. Extensions. *](https://www.nuget.org/packages?q=Microsoft.Extensions.*)ve paket başvurusunun özniteliğinde [System.Net.Http.Js](https://www.nuget.org/packages/System.Net.Http.Json) `Version` 5.0.0 veya sonraki bir sürüme güncelleştirin. Örneğin:

```diff
<ItemGroup>
-    <PackageReference Include="Microsoft.AspNetCore.JsonPatch" Version="3.1.6" />
-    <PackageReference Include="Microsoft.Extensions.Caching.Abstractions" Version="3.1.6" />
-    <PackageReference Include="System.Net.Http.Json" Version="3.2.1" />
+    <PackageReference Include="Microsoft.AspNetCore.JsonPatch" Version="5.0.0" />
+    <PackageReference Include="Microsoft.Extensions.Caching.Abstractions" Version="5.0.0" />
+    <PackageReference Include="System.Net.Http.Json" Version="5.0.0" />
</ItemGroup>
```

## <a name="update-docker-images"></a>Docker görüntülerini güncelleştirme

Docker kullanan uygulamalar için *Dockerfile* `FROM` deyimlerinizi ve betikleri güncelleştirin. ASP.NET Core 5,0 çalışma zamanını içeren bir temel görüntü kullanın. `docker pull`ASP.NET Core 3,1 ve 5,0 arasındaki aşağıdaki komut farkını göz önünde bulundurun:

```diff
- docker pull mcr.microsoft.com/dotnet/core/aspnet:3.1
+ docker pull mcr.microsoft.com/dotnet/aspnet:5.0
```

Ürün adı olarak ".NET" e taşıma kapsamında, Docker görüntüleri `mcr.microsoft.com/dotnet/core` depolardan öğesine taşınır `mcr.microsoft.com/dotnet` . Daha fazla bilgi için bkz. [DotNet/DotNet-Docker # 1939](https://github.com/dotnet/dotnet-docker/issues/1939).

## <a name="model-binding-changes-in-aspnet-core-mvc-and-no-locrazor-pages"></a>ASP.NET Core MVC ve sayfalarında model bağlama değişiklikleri Razor

### <a name="datetime-values-are-model-bound-as-utc-times"></a>DateTime değerleri UTC zamanları olarak modeldir

ASP.NET Core 3,1 ve önceki sürümlerde, `DateTime` değerler saat diliminin sunucu tarafından belirlendiği yerel saat olarak model bağlasıydı. `DateTime` Giriş biçimlendirme (JSON) ve değerleri ile sınırlı değerler `DateTimeOffset` UTC Timezones olarak bağlıydı.

ASP.NET Core 5,0 ve üzeri sürümlerde, model bağlama `DateTime` DEĞERLERI UTC saat dilimiyle tutarlı bir şekilde bağlar.

Önceki davranışı sürdürmek için, `DateTimeModelBinderProvider` içindeki ' ı kaldırın `Startup.ConfigureServices` :

```csharp
services.AddControllersWithViews(options => 
    options.ModelBinderProviders.RemoveType<DateTimeModelBinderProvider>());
```

### <a name="complexobjectmodelbinderprovider--complexobjectmodelbinder-replace-complextypemodelbinderprovider--complextypemodelbinder"></a>ComplexObjectModelBinderProvider \ Complexobjectmodelciltçi Replace ComplexTypeModelBinderProvider \ Complextypemodelciltçi

Model bağlama [C# 9 kayıt türleri](/dotnet/csharp/whats-new/csharp-9#record-types)için destek eklemek üzere, <xref:Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider> Şu olur:

* Eski olarak açıklanmalıdır.
* Artık varsayılan olarak kayıtlı değildir.

Koleksiyonda bulunan öğesinin varlığına bağlı olan uygulamaların `ComplexTypeModelBinderProvider` `ModelBinderProviders` Yeni Ciltçi sağlayıcısına başvurması gerekir:

```diff
- var complexModelBinderProvider = options.ModelBinderProviders.OfType<ComplexTypeModelBinderProvider>();
+ var complexModelBinderProvider = options.ModelBinderProviders.OfType<ComplexObjectModelBinderProvider>();
```

## <a name="review-breaking-changes"></a>Son değişiklikleri gözden geçir

.NET Core 3,1 ' den .NET 5,0 ' ye son değişiklikler için, [sürüm 3,1 ' den 5,0 ' e geçiş Için Son değişiklikler](/dotnet/core/compatibility/3.1-5.0)konusuna bakın ASP.NET Core ve Entity Framework Core listede de bulunur.
